const jsYaml = require('js-yaml')

class YamlTransformer {
  static mimeTypes () {
    return ['text/yaml']
  }

  parse (content) {
    console.log(content);
    
    let data = jsYaml.load(content)

    const arrayConversionApplied = JSON.stringify(data,(key,value)=>{
      if(Array.isArray(value)){
        return {...value};
      }else{
        return value;
      }
    });
    
    data = JSON.parse(arrayConversionApplied);

    console.log(data);

    const fields = typeof data !== 'object' || Array.isArray(data)
    ? { data }
    : data

    
    return { fields }
  }
}

module.exports = YamlTransformer
